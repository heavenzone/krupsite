---
title: 用R语言做线性规划求解
author: Heaven Zone
date: '2018-01-15'
slug: r-linear-programming-solution
categories:
  - R
tags:
  - R
  - 规划求解
simpletoc: true
mathjax: true
---



<div class="section level2">
<h2>简介</h2>
<p>本文将对《数据、模型与决策：基于Excel的建模和商务应用》这本书的第10章规划求解的题目使用R语言来进行线性规划求解。</p>
<p>用到了两个用于做线性规划求解的软件包，分别是：Rglpk、Rsymphony。</p>
</div>
<div class="section level2">
<h2>例题一：生产计划问题</h2>
<p>在本例中，将使用Rglpk包来进行规划求解。</p>
<div id="rglpk" class="section level3">
<h3>Rglpk简介</h3>
<div id="rglpk" class="section level4">
<h4>安装Rglpk</h4>
<pre><code>install.packages(&quot;Rglpk&quot;)</code></pre>
</div>
<div id="rglpk" class="section level4">
<h4>Rglpk用法</h4>
<p><code>Rglpk_solve_LP((obj, mat, dir, rhs, bounds = NULL, types = NULL, max = FALSE,control = list(), ...))</code></p>
</div>
<div class="section level4">
<h4>参数详解</h4>
<table>
<thead>
<tr class="header">
<th align="center">参数</th>
<th align="center">作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">obj</td>
<td align="center">规划目标系数</td>
</tr>
<tr class="even">
<td align="center">mat</td>
<td align="center">约束向量矩阵</td>
</tr>
<tr class="odd">
<td align="center">dir</td>
<td align="center">约束方向向量，有’&gt;’、’&lt;’、’=’构成</td>
</tr>
<tr class="even">
<td align="center">rhs</td>
<td align="center">约束值</td>
</tr>
<tr class="odd">
<td align="center">bounds</td>
<td align="center">上下限的约束，默认0到INF</td>
</tr>
<tr class="even">
<td align="center">type</td>
<td align="center">限定目标变量的类型,’B’指的是0-1规划,’C’代表连续,’I’代表整数，默认是’C’</td>
</tr>
<tr class="odd">
<td align="center">control</td>
<td align="center">包含四个参数verbose、presolve、tm_limit、canonicalize_status。</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3>题目</h3>
<p>一个工厂有车床、刨床、钻床和铣床四种设备。生产A、B、C、D、E五中产品。每种设备每天生产时间为8小时，每年工作日为250天。各种设备台数，全年能力（可用工时），每种设备生产一件分别占用这四种设备的工时（单位：小时），五种产品可以获得的利润（单位：元/件），如下表所示：</p>
<table>
<caption>生产计划问题的数据</caption>
<thead>
<tr class="header">
<th align="center">设备类型</th>
<th align="right">产品A</th>
<th align="right">产品B</th>
<th align="right">产品C</th>
<th align="right">产品D</th>
<th align="right">产品E</th>
<th align="right">设备能力</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">车床</td>
<td align="right">0.23</td>
<td align="right">0.44</td>
<td align="right">0.17</td>
<td align="right">0.08</td>
<td align="right">0.36</td>
<td align="right">24000</td>
</tr>
<tr class="even">
<td align="center">刨床</td>
<td align="right">0.13</td>
<td align="right">0</td>
<td align="right">0.2</td>
<td align="right">0.37</td>
<td align="right">0.19</td>
<td align="right">22000</td>
</tr>
<tr class="odd">
<td align="center">钻床</td>
<td align="right">0</td>
<td align="right">0.25</td>
<td align="right">0.34</td>
<td align="right">0</td>
<td align="right">0.18</td>
<td align="right">16000</td>
</tr>
<tr class="even">
<td align="center">铣床</td>
<td align="right">0.55</td>
<td align="right">0.72</td>
<td align="right">0</td>
<td align="right">0.61</td>
<td align="right">0</td>
<td align="right">12000</td>
</tr>
<tr class="odd">
<td align="center">利润</td>
<td align="right">123</td>
<td align="right">94</td>
<td align="right">105</td>
<td align="right">132</td>
<td align="right">118</td>
<td align="right"></td>
</tr>
</tbody>
</table>
<p>现在我们要确定这五种产品的生产数量，使得占用的设备工时不超过各种设备的能力，同时使利润最大。</p>
</div>
<div class="section level3">
<h3>数学模型</h3>
<p><span class="math display">\[
max(z) = 123x_1+94x_2+105x_3+132x_4+118x_5 \\
\left\{\begin{array}{rl}
\quad 0.23x_1+0.44x_2+0.17x_3+0.08x_4+0.36x_5 \leq 24000 \\
\quad 0.13x_1 \qquad\qquad +0.20x_3+0.37x_4+0.19x_5 \leq 22000 \\
\quad 0.25x_2+0.34x_3 \qquad\qquad +0.18x_5 \leq 16000 \\
\quad 0.55x_1+0.72x_2 \qquad\qquad +0.61x_4 \qquad\qquad \leq 12000 \\
\quad x_1,x_2,x_3,x_4,x_5 \geq0 ，且为正整数\\
\end{array} \right. \\
\]</span></p>
</div>
<div class="section level3">
<h3>代码实现</h3>
<pre class="r"><code>library(Rglpk)

obj &lt;- c(123, 94, 105, 132, 118)
row1 &lt;- c(0.23, 0.44, 0.17, 0.08, 0.36)
row2 &lt;- c(0.13, 0.00, 0.20, 0.37, 0.19)
row3 &lt;- c(0.00, 0.25, 0.34, 0.00, 0.18)
row4 &lt;- c(0.55, 0.72, 0.00, 0.61, 0.00)
mat &lt;- as.matrix(rbind(row1,row2,row3,row4))
mat</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## row1 0.23 0.44 0.17 0.08 0.36
## row2 0.13 0.00 0.20 0.37 0.19
## row3 0.00 0.25 0.34 0.00 0.18
## row4 0.55 0.72 0.00 0.61 0.00</code></pre>
<pre class="r"><code>dir &lt;- c(&quot;&lt;=&quot;, &quot;&lt;=&quot;, &quot;&lt;=&quot;, &quot;&lt;=&quot;)
rhs &lt;- c(24000, 22000, 16000, 12000)
max &lt;- TRUE

rst &lt;- Rglpk_solve_LP(obj, mat, dir, rhs, max = max, types = &quot;I&quot;)
rst</code></pre>
<pre><code>## $optimum
## [1] 10872517
## 
## $solution
## [1]     0     0 18771 19672 53431
## 
## $status
## [1] 0
## 
## $solution_dual
## [1] NA
## 
## $auxiliary
## $auxiliary$primal
## [1] 23999.99 21184.73 15999.72 11999.92
## 
## $auxiliary$dual
## [1] NA</code></pre>
<p>得到结果是：</p>
<p><span class="math display">\[
\left\{\begin{array}{lr}
x_1 = 0 \\
x_2 = 0 \\
x_3 = 18771 \\
x_4 = 19672 \\
x_5 = 53431 \\
\end{array} \right. \\
\]</span></p>
<p>利润最大值为：10872517。</p>
<p>四台设备的使用工时分别为：23999.99, 21184.73, 15999.72, 11999.92</p>
</div>
</div>
<div class="section level2">
<h2>例题二：配料问题</h2>
<p>本例中将会尝试使用Rsymphony包来进行规划求解。</p>
<div id="rsymphony" class="section level3">
<h3>Rsymphony简介</h3>
<div class="section level4">
<h4>安装</h4>
<pre><code>install.package(&quot;Rsymphony&quot;)</code></pre>
</div>
<div class="section level4">
<h4>使用方法</h4>
<p>Rsymphony，混合整数线性规划SYMPHONY 求解器，其中主函数有：</p>
<pre><code>Rsymphony_solve_LP(obj, mat, dir, rhs, bounds = NULL, 
                   types = NULL, max = FALSE, verbosity = -2, 
                   time_limit = -1, node_limit = -1, gap_limit = -1, 
                   first_feasible = FALSE,
                   write_lp = FALSE, write_mps = FALSE)</code></pre>
</div>
<div id="-1" class="section level4">
<h4>参数详解</h4>
<table>
<thead>
<tr class="header">
<th align="center">主要参数</th>
<th align="center">作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">obj</td>
<td align="center">规划目标系数</td>
</tr>
<tr class="even">
<td align="center">mat</td>
<td align="center">约束向量矩阵</td>
</tr>
<tr class="odd">
<td align="center">dir</td>
<td align="center">约束方向向量，有’&gt;’、’&lt;’、’=’构成</td>
</tr>
<tr class="even">
<td align="center">rhs</td>
<td align="center">约束值</td>
</tr>
<tr class="odd">
<td align="center">bounds</td>
<td align="center">上下限的约束，默认0到INF</td>
</tr>
<tr class="even">
<td align="center">type</td>
<td align="center">限定目标变量的类型,’B’指的是0-1规划,’C’代表连</td>
</tr>
<tr class="odd">
<td align="center">max</td>
<td align="center">逻辑值，T为求最大值，F为最小值</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="-1" class="section level3">
<h3>题目</h3>
<p>化肥厂用四种原料A、B、C、D混合成复合肥料，这四种原料的单价以及复合肥料（M）所要求的氮、磷、钾的最低百分量如下表：</p>
<table>
<caption>复合肥料配料问题数据</caption>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
<th align="center">D</th>
<th align="center">M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">氮N</td>
<td align="center">0.3</td>
<td align="center">0.15</td>
<td align="center">0</td>
<td align="center">0.15</td>
<td align="center">0.15</td>
</tr>
<tr class="even">
<td align="center">磷P</td>
<td align="center">0.1</td>
<td align="center">0</td>
<td align="center">0.25</td>
<td align="center">0.15</td>
<td align="center">0.15</td>
</tr>
<tr class="odd">
<td align="center">钾K</td>
<td align="center">0</td>
<td align="center">0.2</td>
<td align="center">0.15</td>
<td align="center">0.15</td>
<td align="center">0.1</td>
</tr>
<tr class="even">
<td align="center">单价(元/吨)</td>
<td align="center">2200</td>
<td align="center">1800</td>
<td align="center">2400</td>
<td align="center">2700</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>要求配1000吨复合肥料，并假定在配置过程中物料没有损耗。</p>
<p>求使得总成本最低的配料方案。</p>
</div>
<div id="-1" class="section level3">
<h3>数学模型</h3>
<p><span class="math display">\[
min(z) = 2200x_1 + 1800x_2 + 2400x_3 + 2700x_4 \\
\left\{\begin{array}{lr}
0.30x_1 + 0.15x_2 + 0.00x_3 + 0.15x_4 \geq 150 \\
0.10x_1 + 0.00x_2 + 0.25x_3 + 0.15x_4 \geq 150 \\
0.00x_1 + 0.20x_2 + 0.15x_3 + 0.15x_4 \geq 100 \\
x_1 + x_2 + x_3 + x_4 = 1000 \\
x_1,x_2,x_3,x_4 \geq 0 \\
\end{array} \right. \\
\]</span></p>
<p>书中<span class="math inline">\(min(z)\)</span>那条公式的系数有误。</p>
</div>
<div id="-1" class="section level3">
<h3>代码实现</h3>
<pre class="r"><code>library(Rsymphony)

obj &lt;- c(2200, 1800, 2400, 2700)
row1 &lt;- c(0.3, 0.15, 0, 0.15)
row2 &lt;- c(0.1, 0.00, 0.25, 0.15)
row3 &lt;- c(0, 0.2, 0.15, 0.15)
row4 &lt;- c(1,1,1,1)

mat &lt;- as.matrix(rbind(row1, row2, row3,row4))

dir &lt;- c(&quot;&gt;=&quot;, &quot;&gt;=&quot;, &quot;&gt;=&quot;,&quot;==&quot;)
rhs &lt;- c(0.15*1000, 0.15*1000, 0.10*1000, 1000)
max &lt;- F

Rsymphony_solve_LP(obj, mat, dir, rhs, max = F)</code></pre>
<pre><code>## $solution
## [1] 375 125 375 125
## 
## $objval
## [1] 2287500
## 
## $status
## TM_OPTIMAL_SOLUTION_FOUND 
##                         0</code></pre>
<pre class="r"><code># 再用例子1中的Rglpk包验证一下答案
Rglpk_solve_LP(obj, mat, dir, rhs, max = F)</code></pre>
<pre><code>## $optimum
## [1] 2287500
## 
## $solution
## [1] 375 125 375 125
## 
## $status
## [1] 0
## 
## $solution_dual
## [1] 0 0 0 0
## 
## $auxiliary
## $auxiliary$primal
## [1]  150  150  100 1000
## 
## $auxiliary$dual
## [1]  7833.333  8750.000  8250.000 -1025.000</code></pre>
<p>可见两个包计出来的结果都是一样的，也跟书中的结果一致。</p>
<blockquote>
<p>运输问题有一个特点：只要供应量和需求量都是整数，那么最优解中的决策变量一定是整数，无需将决策定义成整数变量。</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2>例题三：背包问题</h2>
<div id="-2" class="section level3">
<h3>题目</h3>
<p>一艘货船最大装载重量为5000千克，现有A, B, C, D, E, F六种货物待装运，每种货物单件的价值和重量如下表：</p>
<table>
<thead>
<tr class="header">
<th align="center">物货名称</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">E</th>
<th align="right">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">重量（公斤/件）</td>
<td align="right">320</td>
<td align="right">420</td>
<td align="right">530</td>
<td align="right">550</td>
<td align="right">590</td>
<td align="right">640</td>
</tr>
<tr class="even">
<td align="center">价值（万元/件）</td>
<td align="right">2.75</td>
<td align="right">3.22</td>
<td align="right">4.55</td>
<td align="right">4.73</td>
<td align="right">5.01</td>
<td align="right">5.5</td>
</tr>
</tbody>
</table>
</div>
<div id="-2" class="section level3">
<h3>数学模型</h3>
<p><span class="math display">\[
max(z) = 2.75x_1 + 3.22x_2 + 4.55x_3 + 4.73x_4 + 5.01x_5 + 5.5x_6 \\
\left\{\begin{array}{lr}
320x_1 + 420x_2 + 530x_3 + 550x_4 + 590x_5 + 640x_6 \leq 5000\\
\end{array} \right. \\
\]</span> ### 代码实现</p>
<pre class="r"><code>obj &lt;- c(2.75, 3.22, 4.55, 4.73, 5.01, 5.5)
row1 &lt;- c(320, 420, 530, 550, 590, 640)

mat &lt;- as.matrix(rbind(row1))

dir &lt;- c(&quot;&lt;=&quot;)
rhs &lt;- c(5000)
max &lt;- T
types &lt;- c(&quot;I&quot;)

Rsymphony_solve_LP(obj, mat, dir, rhs, max = max, types = types)</code></pre>
<pre><code>## $solution
## [1] 2 0 2 6 0 0
## 
## $objval
## [1] 42.98
## 
## $status
## TM_OPTIMAL_SOLUTION_FOUND 
##                         0</code></pre>
</div>
</div>
<div class="section level2">
<h2>例题四：物流配送问题</h2>
<p>某种产品从两个生产地A1、A2运往三个需求地B1、B2、B3。各生产低端的生产量、各需求地的需求量、每个生产地到每个需求地每吨产品的运输价格如下表：</p>
<table>
<caption>物流配送问题的数据</caption>
<thead>
<tr class="header">
<th align="center">运价（元/吨）</th>
<th align="right">B1</th>
<th align="right">B2</th>
<th align="right">B3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">A1</td>
<td align="right">12</td>
<td align="right">13</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="center">A2</td>
<td align="right">14</td>
<td align="right">17</td>
<td align="right">8</td>
</tr>
</tbody>
</table>
<p><strong>求</strong>总运费最低的配送方案。</p>
<table>
<caption>变量设置</caption>
<thead>
<tr class="header">
<th align="center">运量</th>
<th align="center">B1</th>
<th align="center">B2</th>
<th align="center">B3</th>
<th align="right">生产量（吨）</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">A1</td>
<td align="center">x11</td>
<td align="center">x12</td>
<td align="center">x13</td>
<td align="right">520</td>
</tr>
<tr class="even">
<td align="center">A2</td>
<td align="center">x21</td>
<td align="center">x22</td>
<td align="center">x23</td>
<td align="right">480</td>
</tr>
<tr class="odd">
<td align="center">需求量（吨）</td>
<td align="center">200</td>
<td align="center">400</td>
<td align="center">400</td>
<td align="right">1000</td>
</tr>
</tbody>
</table>
<p>两个产地的<strong>总产量</strong>和三个需求地的<strong>总需求量</strong>是相等的，这个问题称为<strong>供求平衡的物流配送问题</strong>。</p>
<div id="-3" class="section level3">
<h3>数学模型</h3>
<p><span class="math display">\[
min(z) = 12x_{11} + 13x_{12} + 21x_{13} + 14x_{21} + 17x_{22} + 8x_{23} \\
\left\{\begin{array}{rl}
x_{11} + x_{12} + x_{13} = 520 \\
x_{21} + x_{22} + x_{23} = 480\\
x_{11} + x_{21} = 200 \\
x_{12} + x_{22} = 400 \\
x_{13} + x_{23} = 400 \\
\end{array} \right. \\
\]</span></p>
</div>
<div id="-2" class="section level3">
<h3>代码实现</h3>
<pre class="r"><code>obj &lt;- c(12, 13, 21, 14, 17, 8)
row1 &lt;- c(1, 1, 1, 0, 0, 0)
row2 &lt;- c(0, 0, 0, 1, 1, 1)
row3 &lt;- c(1, 0, 0, 1, 0, 0)
row4 &lt;- c(0, 1, 0, 0, 1, 0)
row5 &lt;- c(0, 0, 1, 0, 0, 1)

mat &lt;- as.matrix(rbind(row1,row2,row3,row4,row5))

dir &lt;- c(&quot;==&quot;, &quot;==&quot;, &quot;==&quot;, &quot;==&quot;, &quot;==&quot;)
rhs &lt;- c(520, 480, 200, 400, 400)
max &lt;- T
types &lt;- c(&quot;I&quot;)

Rsymphony_solve_LP(obj, mat, dir, rhs, max = max, types = types)</code></pre>
<pre><code>## $solution
## [1] 120   0 400  80 400   0
## 
## $objval
## [1] 17760
## 
## $status
## TM_OPTIMAL_SOLUTION_FOUND 
##                         0</code></pre>
</div>
</div>
<div id="0-1" class="section level2">
<h2>例题五：[0, 1]选择问题</h2>
<div id="-3" class="section level3">
<h3>题目</h3>
<p>一家控股公司要在下属的五家子公司中选择三家准备上市。这五家子公司的资产、负债和税后利润如下表：</p>
<table>
<caption>公司选择问题的数据</caption>
<thead>
<tr class="header">
<th align="center">子公司</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">E</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">资产（亿元）</td>
<td align="right">3.48</td>
<td align="right">5.62</td>
<td align="right">7.33</td>
<td align="right">6.27</td>
<td align="right">2.14</td>
</tr>
<tr class="even">
<td align="center">负债（亿元）</td>
<td align="right">1.28</td>
<td align="right">2.53</td>
<td align="right">1.02</td>
<td align="right">3.55</td>
<td align="right">0.53</td>
</tr>
<tr class="odd">
<td align="center">税后利润（万元）</td>
<td align="right">5400</td>
<td align="right">2300</td>
<td align="right">4600</td>
<td align="right">3300</td>
<td align="right">980</td>
</tr>
</tbody>
</table>
<p>要求所选的三家子公司的总资产不低于10亿元，负债不超过5亿元，并使得新组建的公司税后利润最大。</p>
<p>设有5个c(0, 1)的变量，x1,x2,x3,x4,x5，取值如下：</p>
<p><span class="math display">\[
x_i=\left\{\begin{array}{rl}
0 &amp; 不选择的子公司 \\
1 &amp; 选择的子公司 \\
\end{array} \right. \\
\]</span></p>
</div>
<div id="-4" class="section level3">
<h3>数学模型</h3>
<p><span class="math display">\[
min(z) = 5400x_{1} + 2300x_{2} + 4600x_{3} + 3300x_{4} + 980x_{5} \\
\left\{\begin{array}{rl}
&amp; 3.48x_1 + 5.62x_2 + 7.33x_3 + 6.27x_4 + 2.14x_5  \geq 10 \\
&amp; 1.28x_1 + 2.53x_2 + 1.02x_3 + 3.55x_4 + 0.53x_5 \leq 5  \\
&amp; x_1 + x_2 + x_3 + x_4 + x_5 = 3 \\
&amp; x_1, x_2, x_3, x_4, x_5 为 0或1
\end{array} \right. \\
\]</span></p>
</div>
<div id="-3" class="section level3">
<h3>代码实现</h3>
<pre class="r"><code>obj &lt;- c(5400, 2300, 4600, 3300, 980)
row1 &lt;- c(3.48, 5.62, 7.33, 6.27, 2.14)
row2 &lt;- c(1.28, 2.53, 1.02, 3.55, 0.53)
nx &lt;- length(obj)
mat.tmp &lt;- matrix(rep.int(0, nx^2), nrow = nx)
for (i in 1:nx) {
  for (j in 1:nx) {
    if (i == j) {
      mat.tmp[i, j] &lt;- 1
    }
  }
} 

mat &lt;- as.matrix(rbind(row1,row2, mat.tmp))

dir &lt;- c(&quot;&gt;=&quot;, &quot;&lt;=&quot;, rep.int(&quot;&lt;=&quot;, 5))
rhs &lt;- c(10, 5, 1, 1, 1, 1, 1)
max &lt;- TRUE
types &lt;- c(&quot;I&quot;)

Rsymphony_solve_LP(obj, mat, dir, rhs, max = max, types = types)</code></pre>
<pre><code>## $solution
## [1] 1 1 1 0 0
## 
## $objval
## [1] 12300
## 
## $status
## TM_OPTIMAL_SOLUTION_FOUND 
##                         0</code></pre>
<p>输出的结果跟书中一致。</p>
</div>
</div>
<div class="section level2">
<h2>例题六：指派问题</h2>
<div class="section level3">
<h3>指派问题简介</h3>
<p>指派问题：有n项任务由n个人完成，每项任务交给一个人，每人都有一项任务。由i个人完成j项任务的成本（或效益）为<span class="math inline">\(c_{ij}\)</span>。求使总成本最小（或总效益最大）的分配方案。</p>
<p><span class="math display">\[
x_{ij}\left\{\begin{array}{rl}
0 &amp; 第i个人不是从事第j项任务 \\
1 &amp; 第i个人被指派完成第j项任务 \\
\end{array} \right. \\
\]</span></p>
<p>这也是一个c(0, 1)规划问题，这个问题的0-1线性规划模型如下：</p>
<p><span class="math display">\[
max(z)=\sum_{i=1}^{n}\sum_{j=1}^{n}{c_{ij}x_{ij}} \\
\sum_{i=1}^n{x_{ij}}=1 , j = 1,2,\dots,n \\
\sum_{j=1}^n{x_{ij}}=1 , i = 1,2,\dots,n \\
\]</span></p>
<p>这类问题称为指派问题(assignment problem)。</p>
</div>
<div id="-4" class="section level3">
<h3>题目</h3>
<p>市政府有四项市政建设工程招标，经过初选，四家建设公司最后参与这四项工程竞标。每家公司对每个工程的报价如下：</p>
<table>
<caption>各公司的报价</caption>
<thead>
<tr class="header">
<th align="center">公司</th>
<th align="center">工程A</th>
<th align="center">工程B</th>
<th align="center">工程C</th>
<th align="center">工程D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">甲公司</td>
<td align="center">920</td>
<td align="center">480</td>
<td align="center">650</td>
<td align="center">340</td>
</tr>
<tr class="even">
<td align="center">乙公司</td>
<td align="center">870</td>
<td align="center">510</td>
<td align="center">700</td>
<td align="center">350</td>
</tr>
<tr class="odd">
<td align="center">丙公司</td>
<td align="center">880</td>
<td align="center">500</td>
<td align="center">720</td>
<td align="center">400</td>
</tr>
<tr class="even">
<td align="center">丁公司</td>
<td align="center">930</td>
<td align="center">490</td>
<td align="center">680</td>
<td align="center">410</td>
</tr>
</tbody>
</table>
<p>市政府规定，每项工程只能有一家公司中标，每个公司只能承担一项工程。</p>
<p>求总价最低的决标方案。</p>
</div>
<div id="-5" class="section level3">
<h3>数学模型</h3>
<p><span class="math display">\[
max(z)=920x_{11} + 480x_{12} + 650x_{13} + 340x_{14} \\
+ 870x_{21} + 510x_{22} + 700x_{23} + 350x_{24} \\
+ 880x_{31} + 500x_{32} + 720x_{33} + 400x_{34} \\
+ 930x_{41} + 490x_{42} + 680x_{43} + 410x_{44} \\
\left\{\begin{array}{rl}
x_{11} + x_{12} + x_{13} + x_{14} = 1 \\
x_{21} + x_{22} + x_{23} + x_{24} = 1 \\
x_{31} + x_{32} + x_{33} + x_{34} = 1 \\
x_{41} + x_{42} + x_{43} + x_{44} = 1 \\
x_{11} + x_{21} + x_{31} + x_{41} = 1 \\
x_{12} + x_{22} + x_{32} + x_{42} = 1 \\
x_{13} + x_{23} + x_{33} + x_{43} = 1 \\
x_{14} + x_{24} + x_{34} + x_{44} = 1 \\
\end{array} \right. \\
\]</span></p>
<p>前四条约束和后四条约束分别是<strong>每家公司只能承接一项工程</strong>和<strong>每项工程只能由一家公司来承接</strong>。</p>
</div>
<div id="-4" class="section level3">
<h3>代码实现</h3>
<pre class="r"><code>obj &lt;- c(920, 480, 650, 340, 
         870, 510, 700, 350,
         880, 500, 720, 400,
         930, 490, 680, 410
         )
nx &lt;- length(obj) 
mat.length &lt;- nx*8
mat.tmp &lt;- matrix(rep.int(0, mat.length), ncol = 16)

# 生成前四条约束矩阵
j = 1:4
for(i in 1:4) {
    mat.tmp[i, j] = 1
    j = j + 4
    if (j[4] &gt; 16) {
      j = 1:4
    }
}
# 生成后四条约束矩阵
j = c(1,5,9,13)
for(i in 5:8) {
    mat.tmp[i, j] = 1
    j = j + 1
    if (j[4] &gt; 16) {
      j = c(1,5,9,13)
    }
}

mat &lt;- mat.tmp
mat</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## [1,]    1    1    1    1    0    0    0    0    0     0     0     0     0
## [2,]    0    0    0    0    1    1    1    1    0     0     0     0     0
## [3,]    0    0    0    0    0    0    0    0    1     1     1     1     0
## [4,]    0    0    0    0    0    0    0    0    0     0     0     0     1
## [5,]    1    0    0    0    1    0    0    0    1     0     0     0     1
## [6,]    0    1    0    0    0    1    0    0    0     1     0     0     0
## [7,]    0    0    1    0    0    0    1    0    0     0     1     0     0
## [8,]    0    0    0    1    0    0    0    1    0     0     0     1     0
##      [,14] [,15] [,16]
## [1,]     0     0     0
## [2,]     0     0     0
## [3,]     0     0     0
## [4,]     1     1     1
## [5,]     0     0     0
## [6,]     1     0     0
## [7,]     0     1     0
## [8,]     0     0     1</code></pre>
<pre class="r"><code>dir &lt;- rep.int(&quot;==&quot;, 8)
rhs &lt;- rep.int(1, 8)
max &lt;- FALSE

rst &lt;- Rsymphony_solve_LP(obj, mat, dir, rhs, max = max)
matrix(rst$solution, ncol = 4)</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    0    0    1    0
## [2,]    0    0    0    1
## [3,]    1    0    0    0
## [4,]    0    1    0    0</code></pre>
<pre class="r"><code>rst</code></pre>
<pre><code>## $solution
##  [1] 0 0 1 0 0 0 0 1 1 0 0 0 0 1 0 0
## 
## $objval
## [1] 2370
## 
## $status
## TM_OPTIMAL_SOLUTION_FOUND 
##                         0</code></pre>
<p>输出结果与书中结果一致，总报价为2370。书中数学模型中的第一行<code>max z</code>应该为<code>min z</code>，题目要求求最小值，应属笔误，因为结果是对的。</p>
<blockquote>
<p><strong>指派问题</strong>也和<strong>运输问题</strong>有类似的性质，只要约束条件的右边常数都是等于1，最优解中的<strong>决策变量</strong>自然就等于0或1，不比将决策变量定义成0-1变量，如例子六中并没有像例子五那样控制变量小于等于1。</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2>线性规划问题总结</h2>
<p>线性规划两条基本定理：</p>
<ul>
<li>如果线性规划的可行域不是空集，则线性规划的可行域是一个凸集。</li>
<li>线性规划如果有最优解，最优解至少在可行域的一个极点上。</li>
</ul>
<p>线性规划问题的基本概念：</p>
<ul>
<li>决策变量</li>
<li>线性规划的解</li>
<li>目标函数</li>
<li>约束条件</li>
<li>右边常数</li>
<li>变量的符号约束（决策变量&gt;=0或者&lt;=0或没有符号限制）</li>
<li>可行解</li>
<li>可行域</li>
<li>目标函数等值线</li>
<li>目标函数的梯度方向</li>
<li>最优解</li>
</ul>
<p>求解线性规划的算法——<strong>单纯形法</strong></p>
<p>线性规模模型的目标函数必须是变量的线性函数，约束条件必须是变量的现行等式或不等式。</p>
<p>下面这样的就不是线性规划问题：</p>
<p><span class="math display">\[
min(z)=3x_1^2+2x_1x_2 \\
\left\{\begin{array}{rl}
2x_1+\frac{x_2+x_3}{x_1} \leq  8\\
|x_1+x_2|+4x_3 \leq 9 \\
x_1,x_2,x_3 \geq 0 \\
\end{array} \right. \\
\]</span></p>
<p>这是因为：</p>
<ol style="list-style-type: decimal">
<li>目标函数中出现变量的平方以及两个变量的乘积</li>
<li>第一个约束条件的分母中出现变量</li>
<li>第二个约束条件中出现非线性函数</li>
</ol>
<p>另外一些（例子一）：</p>
<ul>
<li><strong>影子价格</strong>越大，那么该变量的变化对结果影响越大。</li>
<li>如果设备能力（例子一）有剩余（<strong>松弛值</strong>&gt;0）该<strong>影子价格</strong>一定等于0。</li>
<li>最优生产计划中安排生产的产品他们的<strong>机会成本</strong>都等于<strong>利润</strong>（即<strong>差额成本</strong>=0）</li>
<li>而<strong>机会成本</strong>大于<strong>利润</strong>的产品，不安排生产（即产量为0）</li>
</ul>
<p>线性规划模型是一种典型的<strong>单目标决策模型</strong>。</p>
</div>
<div id="excel" class="section level2">
<h2>Excel打开规划求解</h2>
<p><code>文件 -&gt; 选项 -&gt; 加载项 -&gt; 转到 -&gt; 规划求解加载项 -&gt; 确定</code></p>
<p>也可以顺带把<strong>分析工具库</strong>也选上。</p>
</div>
<div class="section level2">
<h2>参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="http://blog.csdn.net/qq_27755195/article/details/53759566" class="uri">http://blog.csdn.net/qq_27755195/article/details/53759566</a></li>
<li>蒋绍忠．数据、模型与决策：基于Excel的建模和商务应用[M]．北京：北京大学出版社，2010：355-386．</li>
</ol>
</div>
