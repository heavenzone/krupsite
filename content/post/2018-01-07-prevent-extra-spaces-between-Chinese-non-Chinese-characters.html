---
title: rticles中ctex模板生成pdf的代码部分出现多于空格
author: Heaven Zone
date: '2018-01-07'
slug: prevent-extra-spaces-between-Chinese-non-Chinese-characters
categories:
  - R
tags:
  - R
  - rticles
---



<div class="section level2">
<h2>问题描述</h2>
<p>这个问题其实这几天想在stackoverflow上面问的，鉴于英文水平有限，不知道怎么组织语言，所以一直没有上去问，不过昨天去了一下yihui的博客，看到<a href="https://yihui.name/en/2017/12/so-bounties/">这篇文章</a>，没想到竟然有同胞也问了同样的问题【<a href="https://stackoverflow.com/questions/47990152/bookdown-fix-extra-space-before-chinese-string-inside-r-code-chunk">传送门</a>】，而yihui也给出了解决方案。</p>
<p>yihui这篇博文给了我们beginner很大的鼓励，知道初学者的难处所在，其实yihui也是在鼓励初学者问问题，但是问问题要遵循几个问题，这是yihui在很多地方重复的几个原则：</p>
<ul>
<li>简单</li>
<li>可重现</li>
<li>避免重复</li>
</ul>
<p>其实前两个原则，对于我来说应该不难，但是对于第三个原则“避免重复”，其实是比较难保证的，有些问题确实逛了很多地方都没有找到答案，考虑到“避免重复”这个原则，所以有时候就不敢发问了。</p>
<p>言归正传，这个问题其实就是在rticles中使用ctex模板生成pdf或者用bookdown生成pdf【<a href="https://stackoverflow.com/questions/47990152/bookdown-fix-extra-space-before-chinese-string-inside-r-code-chunk">传送门</a>】时，<strong>在代码部分中的中文字符和非中文字符之间会出现多于的空格</strong>。</p>
</div>
<div class="section level2">
<h2>解决办法</h2>
<p>对于<strong>bookdown</strong>，yihui已经在github上给bookdown做了更新了，请看<a href="https://github.com/yihui/bookdown-chinese/commit/c70ef766b117f3">这里</a>。</p>
<p>其实就是在latex模板上加上下面这句代码，具体原理可看<a href="https://github.com/CTeX-org/ctex-kit/issues/331#issuecomment-353653567">这里</a>：</p>
<pre><code>\RecustomVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\},formatcom=\xeCJKVerbAddon}</code></pre>
<p>由于rticles的ctex模板也是同样的问题，于是自己动手把上面这句代码加到了这个文件<code>\rticles\rmarkdown\templates\ctex\resources\default.latex</code>中，可以打开该文件搜索<code>fancyvrb</code>，然后就可以象下面这样插入上面的代码解决：</p>
<pre><code>\usepackage{fancyvrb}
\VerbatimFootnotes
$endif$

\RecustomVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\},formatcom=\xeCJKVerbAddon}

$if(tables)$</code></pre>
<p>这样，在生成pdf时关于中文的问题基本上都解决了。</p>
</div>
<div class="section level2">
<h2>参考资料</h2>
<ul>
<li><a href="https://github.com/yihui/bookdown-chinese/commit/c70ef766b117f3" class="uri">https://github.com/yihui/bookdown-chinese/commit/c70ef766b117f3</a></li>
<li><a href="https://stackoverflow.com/q/47990152/559676" class="uri">https://stackoverflow.com/q/47990152/559676</a></li>
<li><a href="https://github.com/CTeX-org/ctex-kit/issues/331#issuecomment-353653567" class="uri">https://github.com/CTeX-org/ctex-kit/issues/331#issuecomment-353653567</a></li>
<li><a href="https://github.com/rstudio/rticles/pull/148" class="uri">https://github.com/rstudio/rticles/pull/148</a></li>
</ul>
</div>
