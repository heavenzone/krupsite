---
title: 构建自己的nba实力排行榜
author: Heaven Zone
date: '2017-12-06'
slug: create-my-nba-powerRanking
categories:
  - NBA
tags:
  - NBA
  - R
description: 'R语言用打造自己的NBA实力排行榜'
keyword: 'NBA, R语言'
---



<div class="section level2">
<h2>简介</h2>
<p>一直想根据自己对篮球的理解对NBA实力进行一个实力排名，终于，在学习了R语言之后，可以拿NBA数据来玩玩了。</p>
<p>下面先看看team-stats-per_game表格的列名的解释。</p>
<pre><code>Also view explanations by holding mouse over column headers
Rk -- Rank
G -- Games
MP -- Minutes Played
FG -- Field Goals
FGA -- Field Goal Attempts
FG% -- Field Goal Percentage
3P -- 3-Point Field Goals
3PA -- 3-Point Field Goal Attempts
3P% -- 3-Point Field Goal Percentage
2P -- 2-Point Field Goals
2PA -- 2-point Field Goal Attempts
2P% -- 2-Point Field Goal Percentage
FT -- Free Throws
FTA -- Free Throw Attempts
FT% -- Free Throw Percentage
ORB -- Offensive Rebounds
DRB -- Defensive Rebounds
TRB -- Total Rebounds
AST -- Assists
STL -- Steals
BLK -- Blocks
TOV -- Turnovers
PF -- Personal Fouls
PTS -- Points
</code></pre>
</div>
<div class="section level2">
<h2>载入常用包</h2>
<pre class="r"><code>knitr::opts_chunk$set(
    message = FALSE,
    warning = FALSE,
    echo = TRUE
)
library(XML)
library(xml2)
library(RCurl)
library(rvest)
library(stringr)
library(readxl)
library(tidyverse)
library(htmltab)
library(scales)
library(lubridate)
lastSeason &lt;- &quot;2017&quot;
thisSeason &lt;- &quot;2018&quot;
compTeams &lt;- c(&quot;Warriors&quot;, &quot;Spurs&quot;, &quot;Cavaliers&quot;)</code></pre>
</div>
<div class="section level2">
<h2>2016-2017赛季五项指数</h2>
<div class="section level3">
<h3>抓取数据</h3>
<pre class="r"><code>url &lt;- paste0(&quot;https://www.basketball-reference.com/leagues/NBA_&quot;,lastSeason,&quot;.html&quot;)

webpage &lt;- read_html(url)
webpage.new &lt;- gsub(pattern = &quot;&lt;meta.*?&gt;|&lt;link.*?&gt;|&lt;img.*?&gt;|&lt;a.*?&gt;|&lt;/a&gt;|\r\n|&lt;script.*?&lt;/script&gt;|&lt;style.*?&lt;/style&gt;&quot;,&quot;&quot;,x = webpage)
webpage.new &lt;- gsub(pattern = &quot;&lt;!--((?:(?!(&lt;!--)|(--&gt;))[\\w\\W\u4e00-\u9fa5\r\n])*?&lt;table(?:(?!(&lt;!--)|(--&gt;))[\\w\\W\u4e00-\u9fa5\r\n])*?)--&gt;&quot;,&quot;\\1&quot;,x = webpage.new, perl = TRUE)

webpage.new &lt;- read_html(webpage.new)

webpage.table &lt;- html_nodes(webpage.new, css = &quot;#team-stats-per_game&quot;)
webpage.table &lt;- html_table(webpage.table[[1]])

# 输出5行10列看看数据结构
webpage.table %&gt;% .[1:5, 1:10]</code></pre>
<pre><code>##   Rk                   Team  G    MP   FG  FGA   FG%   3P  3PA   3P%
## 1  1 Golden State Warriors* 82 241.2 43.1 87.1 0.495 12.0 31.2 0.383
## 2  2       Houston Rockets* 82 241.2 40.3 87.2 0.462 14.4 40.3 0.357
## 3  3         Denver Nuggets 82 240.9 41.2 87.7 0.469 10.6 28.8 0.368
## 4  4   Cleveland Cavaliers* 82 242.4 39.9 84.9 0.470 13.0 33.9 0.384
## 5  5    Washington Wizards* 82 242.1 41.3 87.0 0.475  9.2 24.8 0.372</code></pre>
</div>
<div class="section level3">
<h3>分离城市名称和队名</h3>
<pre class="r"><code># 去掉*号
table.teamStatsPerGame &lt;- webpage.table
table.teamStatsPerGame[,&quot;Team&quot;] &lt;- transmute_at(table.teamStatsPerGame,vars(Team),function(.) {gsub(&quot;([*])&quot;, &quot;&quot;, .)})
table.teamStatsPerGame &lt;- table.teamStatsPerGame[-31,]

table.teamStatsPerGame[table.teamStatsPerGame$Team == &quot;Portland Trail Blazers&quot;,&quot;Team&quot;] &lt;- &quot;Portland TrailBlazers&quot;
table.teamStatsPerGame[table.teamStatsPerGame$Team == &quot;Golden State Warriors&quot;,&quot;Team&quot;] &lt;- &quot;GoldenState Warriors&quot;
table.teamStatsPerGame[,&quot;Team&quot;] &lt;- transmute_at(table.teamStatsPerGame,vars(Team),function(.) {gsub(&quot;(^[\\w]*?)\\s([\\w]*?\\s[\\w]*?$)&quot;, &quot;\\1\\2&quot;, . , perl = TRUE)})
# 处理列名称
names(table.teamStatsPerGame) &lt;- gsub(&quot;%&quot;,&quot;pct&quot;,names(table.teamStatsPerGame))
names(table.teamStatsPerGame) &lt;- gsub(&quot;3&quot;,&quot;Three&quot;,names(table.teamStatsPerGame))
names(table.teamStatsPerGame) &lt;- gsub(&quot;2&quot;,&quot;Two&quot;,names(table.teamStatsPerGame))

table.teamStatsPerGame &lt;- table.teamStatsPerGame %&gt;% separate(col = &quot;Team&quot;,into = c(&quot;City&quot;, &quot;TeamName&quot;), sep = &quot; &quot;)

# 输出查看数据机构
table.teamStatsPerGame[1:5, 2:7]</code></pre>
<pre><code>##          City  TeamName  G    MP   FG  FGA
## 1 GoldenState  Warriors 82 241.2 43.1 87.1
## 2     Houston   Rockets 82 241.2 40.3 87.2
## 3      Denver   Nuggets 82 240.9 41.2 87.7
## 4   Cleveland Cavaliers 82 242.4 39.9 84.9
## 5  Washington   Wizards 82 242.1 41.3 87.0</code></pre>
</div>
<div class="section level3">
<h3>构建五项实力指数</h3>
<p>得分：得分0.3+三分命中率0.1+三分命中次数0.25+二分命中率0.25+二分命中次数0.1 篮板：进攻篮板0.55+防守篮板0.45 组织：助攻AST0.55，-失误TOV0.45 防守：盖帽0.5，抢断0.5 罚球：罚球命中次数0.45，罚球命中率0.2，犯规-PF0.35</p>
<div class="section level4">
<h4>标准化数据</h4>
<pre class="r"><code>nbastats.rescale &lt;- table.teamStatsPerGame %&gt;%
  mutate_if(.predicate = is.numeric, rescale)
names(nbastats.rescale)</code></pre>
<pre><code>##  [1] &quot;Rk&quot;        &quot;City&quot;      &quot;TeamName&quot;  &quot;G&quot;         &quot;MP&quot;       
##  [6] &quot;FG&quot;        &quot;FGA&quot;       &quot;FGpct&quot;     &quot;ThreeP&quot;    &quot;ThreePA&quot;  
## [11] &quot;ThreePpct&quot; &quot;TwoP&quot;      &quot;TwoPA&quot;     &quot;TwoPpct&quot;   &quot;FT&quot;       
## [16] &quot;FTA&quot;       &quot;FTpct&quot;     &quot;ORB&quot;       &quot;DRB&quot;       &quot;TRB&quot;      
## [21] &quot;AST&quot;       &quot;STL&quot;       &quot;BLK&quot;       &quot;TOV&quot;       &quot;PF&quot;       
## [26] &quot;PTS&quot;</code></pre>
</div>
<div class="section level4">
<h4>计算五项实力指数</h4>
<pre class="r"><code>nba.shili &lt;- transmute(nbastats.rescale,球队 = TeamName, 
                       得分 = PTS*0.3+ThreePpct*0.1+ThreeP*0.25+TwoPpct*0.25+TwoP*0.1,
                       篮板 = ORB*0.55+DRB*0.45,
                       组织 = AST*0.55+(1-TOV)*0.45,
                       防守 = BLK*0.5+STL*0.5,
                       罚球 = FT*0.6+FTpct*0.2+(1-PF)*0.2)</code></pre>
</div>
</div>
<div class="section level3">
<h3>综合实力可视化分析</h3>
<pre class="r"><code>windowsFonts(yahei = &quot;MS YAHEI&quot;)
nba.shili.rescale &lt;- nba.shili %&gt;%
  mutate_if(.predicate = is.numeric, rescale)

lastSeasonTitle &lt;- paste0(as.character(as.numeric(lastSeason)-1),&quot;-&quot;,lastSeason,&quot;赛季5项数据分析&quot;)
nba.shili.rescale %&gt;% 
  select(球队, 得分, 篮板, 组织, 防守, 罚球) %&gt;%
  dplyr::filter(球队 %in% compTeams) %&gt;%
  ggradar::ggradar(plot.data = .,font.radar = &quot;yahei&quot;,
                 group.point.size = 3, 
                 axis.label.size = 4, 
                 legend.text.size = 12) + 
  ggtitle(lastSeasonTitle)</code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
</div>
<div id="-1" class="section level2">
<h2>2017-2018赛季五项指数</h2>
<p>复制上面代码，对本赛季的team-stats-per_game数据进行抓取分析。</p>
<pre class="r"><code>url.thisSeason &lt;- paste0(&quot;https://www.basketball-reference.com/leagues/NBA_&quot;,thisSeason,&quot;.html&quot;)
webpage.thisSeason &lt;- read_html(url.thisSeason)
webpage.thisSeason &lt;- gsub(pattern = &quot;&lt;meta.*?&gt;|&lt;link.*?&gt;|&lt;img.*?&gt;|&lt;a.*?&gt;|&lt;/a&gt;|\r\n|&lt;script.*?&lt;/script&gt;|&lt;style.*?&lt;/style&gt;&quot;,&quot;&quot;,x = webpage.thisSeason)
webpage.thisSeason &lt;- gsub(pattern = &quot;&lt;!--((?:(?!(&lt;!--)|(--&gt;))[\\w\\W\u4e00-\u9fa5\r\n])*?&lt;table(?:(?!(&lt;!--)|(--&gt;))[\\w\\W\u4e00-\u9fa5\r\n])*?)--&gt;&quot;,&quot;\\1&quot;,x = webpage.thisSeason, perl = TRUE)
webpage.thisSeason &lt;- read_html(webpage.thisSeason)
table.thisSeason &lt;- html_nodes(webpage.thisSeason, css = &quot;#team-stats-per_game&quot;)
table.thisSeason &lt;- html_table(table.thisSeason[[1]])
table.thisSeason.stats &lt;- table.thisSeason
table.thisSeason.stats[,&quot;Team&quot;] &lt;- transmute_at(table.thisSeason.stats,vars(Team),function(.) {gsub(&quot;([*])&quot;, &quot;&quot;, .)})
table.thisSeason.stats &lt;- table.thisSeason.stats[-31,]
table.thisSeason.stats[table.thisSeason.stats$Team == &quot;Portland Trail Blazers&quot;,&quot;Team&quot;] &lt;- &quot;Portland TrailBlazers&quot;
table.thisSeason.stats[table.thisSeason.stats$Team == &quot;Golden State Warriors&quot;,&quot;Team&quot;] &lt;- &quot;GoldenState Warriors&quot;
table.thisSeason.stats[,&quot;Team&quot;] &lt;- transmute_at(table.thisSeason.stats,vars(Team),function(.) {gsub(&quot;(^[\\w]*?)\\s([\\w]*?\\s[\\w]*?$)&quot;, &quot;\\1\\2&quot;, . , perl = TRUE)})
names(table.thisSeason.stats) &lt;- gsub(&quot;%&quot;,&quot;pct&quot;,names(table.thisSeason.stats))
names(table.thisSeason.stats) &lt;- gsub(&quot;3&quot;,&quot;Three&quot;,names(table.thisSeason.stats))
names(table.thisSeason.stats) &lt;- gsub(&quot;2&quot;,&quot;Two&quot;,names(table.thisSeason.stats))
table.thisSeason.stats &lt;- table.thisSeason.stats %&gt;% separate(col = &quot;Team&quot;,into = c(&quot;City&quot;, &quot;TeamName&quot;), sep = &quot; &quot;)

# 标准化数据 #
thisSeason.stats.rescale &lt;- table.thisSeason.stats %&gt;%
  mutate_if(.predicate = is.numeric, rescale)

# 本赛季五项指数 #
thisSeason.nba.shili &lt;- transmute(thisSeason.stats.rescale,球队 = TeamName, 
                       得分 = PTS*0.3+ThreePpct*0.1+ThreeP*0.25+TwoPpct*0.25+TwoP*0.1,
                       篮板 = ORB*0.55+DRB*0.45,
                       组织 = AST*0.55+(1-TOV)*0.45,
                       防守 = BLK*0.5+STL*0.5,
                       罚球 = FT*0.6+FTpct*0.2+(1-PF)*0.2)

# 再次标准化数据 #
thisSeason.nba.shili.rescale &lt;- thisSeason.nba.shili %&gt;%
  mutate_if(.predicate = is.numeric, rescale)

# 雷达图可视化 #
thisSeasonTitle &lt;- paste0(as.character(as.numeric(thisSeason)-1),&quot;-&quot;,thisSeason,&quot;赛季5项数据分析&quot;)
thisSeason.nba.shili.rescale %&gt;% 
  select(球队, 得分, 篮板, 组织, 防守, 罚球) %&gt;%
  dplyr::filter(球队 %in% compTeams) %&gt;%
  ggradar::ggradar(plot.data = .,font.radar = &quot;yahei&quot;,
                 group.point.size = 3, 
                 axis.label.size = 4, 
                 legend.text.size = 12) +
  ggtitle(thisSeasonTitle)</code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="10" class="section level2">
<h2>2017-2018赛季最近10场胜率分析</h2>
<p>由于basket-reference网站的standing表格没有最近10场比赛的胜率，所以到espn的网站去抓了。</p>
<pre class="r"><code>urlespn &lt;- &quot;http://www.espn.com/nba/standings/_/group/league&quot;
webpage.espn &lt;- read_html(urlespn)
webpage.espn.new &lt;- webpage.espn
#write_file(webpage.espn.new, path = &quot;data/test.html&quot;)
webpage.espn.new &lt;- gsub(pattern = &quot;&lt;abbr.*?/abbr&gt;&quot;, &quot;&quot;, x = webpage.espn.new)
webpage.espn.new &lt;- gsub(pattern = &quot;&lt;footer.*?/footer&gt;&quot;, &quot;&quot;, x = webpage.espn.new)
webpage.espn.new &lt;- gsub(pattern = &quot;&lt;a.*?&gt;|&lt;/a&gt;|&lt;span.*?&gt;|&lt;/span&gt;&quot;, &quot;&quot;, x = webpage.espn.new)
webpage.espn.new &lt;- gsub(pattern = &quot;&lt;script.*?/script&gt;&quot;, &quot;&quot;, x = webpage.espn.new)
webpage.espn.new &lt;- gsub(pattern = &quot;&lt;thead.*?&gt;&quot;, &quot;&lt;thead&gt;&lt;tr&gt;&quot;, x = webpage.espn.new)
webpage.espn.new &lt;- gsub(pattern = &quot;&lt;/thead&gt;&quot;, &quot;&lt;/tr&gt;&lt;/thead&gt;&quot;, x = webpage.espn.new)

webpage.espn.new &lt;- read_html(webpage.espn.new)
table.last.ten &lt;- html_nodes(webpage.espn.new, css = &quot;table.standings&quot;)
table.last.ten &lt;- html_table(table.last.ten[[1]])
names(table.last.ten)[1] &lt;- &quot;Team&quot;

# 处理队名
table.last.ten[table.last.ten$Team == &quot;Portland Trail Blazers&quot;,&quot;Team&quot;] &lt;- &quot;Portland TrailBlazers&quot;
table.last.ten[,&quot;Team&quot;] &lt;- transmute_at(table.last.ten,vars(Team),function(.) {gsub(&quot;(^[\\w]*?)\\s([\\w]*?\\s[\\w]*?$)&quot;, &quot;\\1\\2&quot;, . , perl = TRUE)})
table.last.ten &lt;- table.last.ten %&gt;% separate(col = &quot;Team&quot;,into = c(&quot;City&quot;, &quot;TeamName&quot;), sep = &quot; &quot;)
table.last.ten &lt;- table.last.ten %&gt;% separate(col = &quot;L10&quot;,into = c(&quot;L10Win&quot;, &quot;L10Lost&quot;), sep = &quot;-&quot;)
table.last.ten &lt;- table.last.ten %&gt;% mutate_at(.vars = c(&quot;L10Win&quot;,&quot;L10Lost&quot;), as.numeric)
table.last.ten &lt;- table.last.ten %&gt;% mutate(最近十场胜率 = L10Win / (L10Win + L10Lost))

table.last.ten.rescale &lt;- table.last.ten %&gt;% 
  transmute_at(.vars = &quot;最近十场胜率&quot;, rescale) %&gt;%
  bind_cols(球队 = table.last.ten$TeamName, .)

thisSeason.nba.shili.rescale &lt;- left_join(thisSeason.nba.shili.rescale, table.last.ten.rescale[,c(&quot;球队&quot;,&quot;最近十场胜率&quot;)], by = &quot;球队&quot; )</code></pre>
<div id="-1" class="section level3">
<h3>综合实力可视化分析</h3>
<p>加上最近10场比赛的胜率后，我们再做一次综合实力的雷达图展示。</p>
<pre class="r"><code>windowsFonts(yahei = &quot;MS YAHEI&quot;)
thisSeason.nba.shili.rescale %&gt;% 
  select(球队, 得分, 篮板, 组织, 防守, 罚球, 最近十场胜率) %&gt;%
  dplyr::filter(球队 %in% compTeams) %&gt;%
  ggradar::ggradar(plot.data = .,font.radar = &quot;yahei&quot;,
                 group.point.size = 3, 
                 axis.label.size = 4, 
                 legend.text.size = 12)+
  ggtitle(thisSeasonTitle)</code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
<div id="hgranking" class="section level2">
<h2>生成hgRanking</h2>
<p>我们构建当前实力的公式：</p>
<p><span class="math display">\[目前实力=上赛季5项总实力\times0.2+本赛季5项总实力\times0.45+最近10场实力\times0.35\]</span></p>
<pre class="r"><code>nba.total &lt;- nba.shili.rescale %&gt;%
  transmute(球队 = 球队, 上赛季实力 = rowSums(.[,-1]))
tmp &lt;- thisSeason.nba.shili.rescale %&gt;%
  transmute(球队 = 球队, 本赛季实力 = rowSums(.[,-c(1,7)]))
nba.total &lt;- left_join(nba.total, tmp, by = &quot;球队&quot;)
nba.total &lt;- left_join(nba.total, thisSeason.nba.shili.rescale[,c(&quot;球队&quot;,&quot;最近十场胜率&quot;)], by = &quot;球队&quot;)
nba.total.rescale &lt;- nba.total %&gt;%
  mutate_if(.predicate = is.numeric, rescale)

nba.total.rescale &lt;- nba.total.rescale %&gt;% 
  transmute(总实力 = 上赛季实力*0.2 + 本赛季实力*0.45 +最近十场胜率*0.35) %&gt;%
  bind_cols(nba.total.rescale, .)</code></pre>
<p>目前时间是Wed Dec 06 16:00:50 2017，根据上面模型生成实力榜：</p>
<pre class="r"><code># hgRanking
nba.shilibang &lt;- nba.total.rescale %&gt;%
  transmute(球队 = 球队, hgRanking = rank(desc(总实力), ties.method = &quot;min&quot;))
# 本赛季总胜率排名
nba.shilibang &lt;- table.last.ten %&gt;%
  transmute(球队 = TeamName, 本赛季胜率排名 = rank(desc(PCT), ties.method = &quot;min&quot;)) %&gt;%
  left_join(nba.shilibang, . , by = &quot;球队&quot;)

nba.shilibang %&gt;% arrange(hgRanking) %&gt;%
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">球队</th>
<th align="right">hgRanking</th>
<th align="center">本赛季胜率排名</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Warriors</td>
<td align="right">1</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="left">Rockets</td>
<td align="right">2</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="left">Cavaliers</td>
<td align="right">3</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="left">Raptors</td>
<td align="right">4</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="left">Celtics</td>
<td align="right">5</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Spurs</td>
<td align="right">6</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="left">Pacers</td>
<td align="right">7</td>
<td align="center">12</td>
</tr>
<tr class="even">
<td align="left">Timberwolves</td>
<td align="right">8</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="left">Jazz</td>
<td align="right">9</td>
<td align="center">15</td>
</tr>
<tr class="even">
<td align="left">Nuggets</td>
<td align="right">10</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="left">Hornets</td>
<td align="right">11</td>
<td align="center">20</td>
</tr>
<tr class="even">
<td align="left">76ers</td>
<td align="right">12</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="left">TrailBlazers</td>
<td align="right">13</td>
<td align="center">12</td>
</tr>
<tr class="even">
<td align="left">Wizards</td>
<td align="right">14</td>
<td align="center">12</td>
</tr>
<tr class="odd">
<td align="left">Thunder</td>
<td align="right">15</td>
<td align="center">17</td>
</tr>
<tr class="even">
<td align="left">Bucks</td>
<td align="right">16</td>
<td align="center">11</td>
</tr>
<tr class="odd">
<td align="left">Pelicans</td>
<td align="right">17</td>
<td align="center">16</td>
</tr>
<tr class="even">
<td align="left">Nets</td>
<td align="right">18</td>
<td align="center">22</td>
</tr>
<tr class="odd">
<td align="left">Suns</td>
<td align="right">19</td>
<td align="center">26</td>
</tr>
<tr class="even">
<td align="left">Knicks</td>
<td align="right">20</td>
<td align="center">17</td>
</tr>
<tr class="odd">
<td align="left">Clippers</td>
<td align="right">21</td>
<td align="center">23</td>
</tr>
<tr class="even">
<td align="left">Pistons</td>
<td align="right">22</td>
<td align="center">7</td>
</tr>
<tr class="odd">
<td align="left">Mavericks</td>
<td align="right">23</td>
<td align="center">28</td>
</tr>
<tr class="even">
<td align="left">Hawks</td>
<td align="right">24</td>
<td align="center">29</td>
</tr>
<tr class="odd">
<td align="left">Magic</td>
<td align="right">25</td>
<td align="center">21</td>
</tr>
<tr class="even">
<td align="left">Heat</td>
<td align="right">26</td>
<td align="center">17</td>
</tr>
<tr class="odd">
<td align="left">Lakers</td>
<td align="right">27</td>
<td align="center">24</td>
</tr>
<tr class="even">
<td align="left">Grizzlies</td>
<td align="right">28</td>
<td align="center">24</td>
</tr>
<tr class="odd">
<td align="left">Kings</td>
<td align="right">29</td>
<td align="center">27</td>
</tr>
<tr class="even">
<td align="left">Bulls</td>
<td align="right">30</td>
<td align="center">30</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3>模型评价</h3>
<p>下面看看这个业余模型效果如何。</p>
<pre class="r"><code>nba.shilibang.test &lt;- nba.shilibang %&gt;% mutate(与实际胜率差距 = abs(hgRanking - 本赛季胜率排名))
less5 &lt;- nba.shilibang.test %&gt;% dplyr::filter(与实际胜率差距 &lt;= 5) %&gt;% count %&gt;% .[[1]]
less3 &lt;- nba.shilibang.test %&gt;% dplyr::filter(与实际胜率差距 &lt;= 3) %&gt;% count %&gt;% .[[1]]</code></pre>
<ul>
<li><strong>hgRanking</strong>和<strong>本赛季胜率排名</strong>的平均差距是3.6666667。</li>
<li>差距<strong>小于5</strong>名的有25，占比0.83。</li>
<li>差距<strong>小于3</strong>名的有16，占比0.53。</li>
</ul>
<p>下面我们在输出表格和直方图看看效果。</p>
<pre class="r"><code># 表格
nba.shilibang.test %&gt;% arrange(hgRanking) %&gt;%
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">球队</th>
<th align="right">hgRanking</th>
<th align="center">本赛季胜率排名</th>
<th align="center">与实际胜率差距</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Warriors</td>
<td align="right">1</td>
<td align="center">3</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Rockets</td>
<td align="right">2</td>
<td align="center">2</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="left">Cavaliers</td>
<td align="right">3</td>
<td align="center">4</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Raptors</td>
<td align="right">4</td>
<td align="center">5</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="left">Celtics</td>
<td align="right">5</td>
<td align="center">1</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="left">Spurs</td>
<td align="right">6</td>
<td align="center">6</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="left">Pacers</td>
<td align="right">7</td>
<td align="center">12</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="left">Timberwolves</td>
<td align="right">8</td>
<td align="center">10</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="left">Jazz</td>
<td align="right">9</td>
<td align="center">15</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="left">Nuggets</td>
<td align="right">10</td>
<td align="center">8</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="left">Hornets</td>
<td align="right">11</td>
<td align="center">20</td>
<td align="center">9</td>
</tr>
<tr class="even">
<td align="left">76ers</td>
<td align="right">12</td>
<td align="center">8</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="left">TrailBlazers</td>
<td align="right">13</td>
<td align="center">12</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Wizards</td>
<td align="right">14</td>
<td align="center">12</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="left">Thunder</td>
<td align="right">15</td>
<td align="center">17</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Bucks</td>
<td align="right">16</td>
<td align="center">11</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="left">Pelicans</td>
<td align="right">17</td>
<td align="center">16</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Nets</td>
<td align="right">18</td>
<td align="center">22</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="left">Suns</td>
<td align="right">19</td>
<td align="center">26</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="left">Knicks</td>
<td align="right">20</td>
<td align="center">17</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="left">Clippers</td>
<td align="right">21</td>
<td align="center">23</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Pistons</td>
<td align="right">22</td>
<td align="center">7</td>
<td align="center">15</td>
</tr>
<tr class="odd">
<td align="left">Mavericks</td>
<td align="right">23</td>
<td align="center">28</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="left">Hawks</td>
<td align="right">24</td>
<td align="center">29</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="left">Magic</td>
<td align="right">25</td>
<td align="center">21</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="left">Heat</td>
<td align="right">26</td>
<td align="center">17</td>
<td align="center">9</td>
</tr>
<tr class="odd">
<td align="left">Lakers</td>
<td align="right">27</td>
<td align="center">24</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="left">Grizzlies</td>
<td align="right">28</td>
<td align="center">24</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="left">Kings</td>
<td align="right">29</td>
<td align="center">27</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Bulls</td>
<td align="right">30</td>
<td align="center">30</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code># 直方图
ggplot(nba.shilibang.test, aes(与实际胜率差距)) + 
  geom_histogram(binwidth = 0.5)</code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="espnpower-rankings" class="section level3">
<h3>加入ESPN的power-rankings来对比</h3>
<pre class="r"><code>url.pr &lt;- &quot;http://www.espn.com/nba/story/_/page/Basketball-Power-Index/espn-nba-basketball-power-index&quot;
webpage.pr.tmp &lt;- read_html(url.pr)
webpage.pr &lt;- gsub(pattern = &quot;&lt;meta.*?&gt;|&lt;link.*?&gt;|&lt;img.*?&gt;|&lt;a.*?&gt;|&lt;/a&gt;|\r\n|&lt;script.*?&lt;/script&gt;|&lt;style.*?&lt;/style&gt;&quot;,&quot;&quot;,x = webpage.pr.tmp)

webpage.pr &lt;- read_html(webpage.pr)

table.pr &lt;- html_nodes(webpage.pr, css = &quot;table.inline-table&quot;)
table.pr &lt;- html_table(table.pr[[1]])
table.pr &lt;- table.pr[,-c(2,6)]
table.pr &lt;- table.pr %&gt;% separate(col = &quot;RANK&quot;,into = c(&quot;RANK&quot;, &quot;shortName&quot;), sep = &quot;. &quot;)
table.pr[,1] &lt;- as.numeric(table.pr[,1])

# 处理队名
nba.teamName &lt;- read.csv(&quot;../../data/nba-teamName.csv&quot;, stringsAsFactors = FALSE)

table.pr &lt;- left_join(table.pr, nba.teamName[,c(&quot;teamName&quot;,&quot;shortName&quot;)], by = &quot;shortName&quot;)
names(table.pr)[c(1, 6)] &lt;- c(&quot;powerRanking&quot;, &quot;球队&quot;)

nba.shilibang.test &lt;- nba.shilibang.test %&gt;% left_join(table.pr[,c(&quot;球队&quot;, &quot;powerRanking&quot;)], by = &quot;球队&quot;)</code></pre>
<div id="powerranking" class="section level4">
<h4>看看预测排名和PowerRanking的差别</h4>
<pre class="r"><code>nba.shilibang.test &lt;- nba.shilibang.test %&gt;% mutate(与PowerRanking差距 = abs(hgRanking - powerRanking))
pr.less5 &lt;- nba.shilibang.test %&gt;% dplyr::filter(与PowerRanking差距 &lt;= 5) %&gt;% count %&gt;% .[[1]]
pr.less3 &lt;- nba.shilibang.test %&gt;% dplyr::filter(与PowerRanking差距 &lt;= 3) %&gt;% count %&gt;% .[[1]]</code></pre>
<ul>
<li><strong>hgRanking</strong>和<strong>本赛季胜率排名</strong>的平均差距是3.4。</li>
<li>差距<strong>小于5</strong>名的有22，占比0.73。</li>
<li>差距<strong>小于3</strong>名的有19，占比0.63。</li>
</ul>
<pre class="r"><code>nba.shilibang.test %&gt;% arrange(hgRanking) %&gt;%
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">球队</th>
<th align="right">hgRanking</th>
<th align="center">本赛季胜率排名</th>
<th align="center">与实际胜率差距</th>
<th align="right">powerRanking</th>
<th align="center">与PowerRanking差距</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Warriors</td>
<td align="right">1</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="right">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="left">Rockets</td>
<td align="right">2</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="right">2</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="left">Cavaliers</td>
<td align="right">3</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="right">7</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="left">Raptors</td>
<td align="right">4</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="right">4</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="left">Celtics</td>
<td align="right">5</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="right">3</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Spurs</td>
<td align="right">6</td>
<td align="center">6</td>
<td align="center">0</td>
<td align="right">5</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="left">Pacers</td>
<td align="right">7</td>
<td align="center">12</td>
<td align="center">5</td>
<td align="right">18</td>
<td align="center">11</td>
</tr>
<tr class="even">
<td align="left">Timberwolves</td>
<td align="right">8</td>
<td align="center">10</td>
<td align="center">2</td>
<td align="right">10</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="left">Jazz</td>
<td align="right">9</td>
<td align="center">15</td>
<td align="center">6</td>
<td align="right">8</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Nuggets</td>
<td align="right">10</td>
<td align="center">8</td>
<td align="center">2</td>
<td align="right">16</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="left">Hornets</td>
<td align="right">11</td>
<td align="center">20</td>
<td align="center">9</td>
<td align="right">17</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="left">76ers</td>
<td align="right">12</td>
<td align="center">8</td>
<td align="center">4</td>
<td align="right">11</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="left">TrailBlazers</td>
<td align="right">13</td>
<td align="center">12</td>
<td align="center">1</td>
<td align="right">12</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Wizards</td>
<td align="right">14</td>
<td align="center">12</td>
<td align="center">2</td>
<td align="right">9</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="left">Thunder</td>
<td align="right">15</td>
<td align="center">17</td>
<td align="center">2</td>
<td align="right">6</td>
<td align="center">9</td>
</tr>
<tr class="even">
<td align="left">Bucks</td>
<td align="right">16</td>
<td align="center">11</td>
<td align="center">5</td>
<td align="right">14</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="left">Pelicans</td>
<td align="right">17</td>
<td align="center">16</td>
<td align="center">1</td>
<td align="right">15</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Nets</td>
<td align="right">18</td>
<td align="center">22</td>
<td align="center">4</td>
<td align="right">25</td>
<td align="center">7</td>
</tr>
<tr class="odd">
<td align="left">Suns</td>
<td align="right">19</td>
<td align="center">26</td>
<td align="center">7</td>
<td align="right">28</td>
<td align="center">9</td>
</tr>
<tr class="even">
<td align="left">Knicks</td>
<td align="right">20</td>
<td align="center">17</td>
<td align="center">3</td>
<td align="right">22</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="left">Clippers</td>
<td align="right">21</td>
<td align="center">23</td>
<td align="center">2</td>
<td align="right">19</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Pistons</td>
<td align="right">22</td>
<td align="center">7</td>
<td align="center">15</td>
<td align="right">13</td>
<td align="center">9</td>
</tr>
<tr class="odd">
<td align="left">Mavericks</td>
<td align="right">23</td>
<td align="center">28</td>
<td align="center">5</td>
<td align="right">24</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Hawks</td>
<td align="right">24</td>
<td align="center">29</td>
<td align="center">5</td>
<td align="right">27</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="left">Magic</td>
<td align="right">25</td>
<td align="center">21</td>
<td align="center">4</td>
<td align="right">23</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Heat</td>
<td align="right">26</td>
<td align="center">17</td>
<td align="center">9</td>
<td align="right">21</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="left">Lakers</td>
<td align="right">27</td>
<td align="center">24</td>
<td align="center">3</td>
<td align="right">26</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Grizzlies</td>
<td align="right">28</td>
<td align="center">24</td>
<td align="center">4</td>
<td align="right">20</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="left">Kings</td>
<td align="right">29</td>
<td align="center">27</td>
<td align="center">2</td>
<td align="right">29</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="left">Bulls</td>
<td align="right">30</td>
<td align="center">30</td>
<td align="center">0</td>
<td align="right">30</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code># 直方图
ggplot(nba.shilibang.test, aes(与PowerRanking差距)) + 
  geom_histogram(binwidth = 0.5)</code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="powerranking" class="section level4">
<h4>看看胜率排名和PowerRanking的差别</h4>
<pre class="r"><code>nba.shilibang.test &lt;- nba.shilibang.test %&gt;% mutate(胜率与PowerRanking差距 = abs(本赛季胜率排名 - powerRanking))
pct.pr.less5 &lt;- nba.shilibang.test %&gt;% dplyr::filter(胜率与PowerRanking差距 &lt;= 5) %&gt;% count %&gt;% .[[1]]
pct.pr.less3 &lt;- nba.shilibang.test %&gt;% dplyr::filter(胜率与PowerRanking差距 &lt;= 3) %&gt;% count %&gt;% .[[1]]</code></pre>
<ul>
<li><strong>hgRanking</strong>和<strong>本赛季胜率排名</strong>的平均差距是3.1333333。</li>
<li>差距<strong>小于5</strong>名的有25，占比0.83。</li>
<li>差距<strong>小于3</strong>名的有20，占比0.67。</li>
</ul>
<pre class="r"><code>nba.shilibang.test %&gt;% arrange(hgRanking) %&gt;%
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">球队</th>
<th align="right">hgRanking</th>
<th align="center">本赛季胜率排名</th>
<th align="center">与实际胜率差距</th>
<th align="right">powerRanking</th>
<th align="center">与PowerRanking差距</th>
<th align="center">胜率与PowerRanking差距</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Warriors</td>
<td align="right">1</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="right">1</td>
<td align="center">0</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Rockets</td>
<td align="right">2</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="right">2</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="left">Cavaliers</td>
<td align="right">3</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="right">7</td>
<td align="center">4</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="left">Raptors</td>
<td align="right">4</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="right">4</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="left">Celtics</td>
<td align="right">5</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="right">3</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Spurs</td>
<td align="right">6</td>
<td align="center">6</td>
<td align="center">0</td>
<td align="right">5</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="left">Pacers</td>
<td align="right">7</td>
<td align="center">12</td>
<td align="center">5</td>
<td align="right">18</td>
<td align="center">11</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="left">Timberwolves</td>
<td align="right">8</td>
<td align="center">10</td>
<td align="center">2</td>
<td align="right">10</td>
<td align="center">2</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="left">Jazz</td>
<td align="right">9</td>
<td align="center">15</td>
<td align="center">6</td>
<td align="right">8</td>
<td align="center">1</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="left">Nuggets</td>
<td align="right">10</td>
<td align="center">8</td>
<td align="center">2</td>
<td align="right">16</td>
<td align="center">6</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="left">Hornets</td>
<td align="right">11</td>
<td align="center">20</td>
<td align="center">9</td>
<td align="right">17</td>
<td align="center">6</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="left">76ers</td>
<td align="right">12</td>
<td align="center">8</td>
<td align="center">4</td>
<td align="right">11</td>
<td align="center">1</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="left">TrailBlazers</td>
<td align="right">13</td>
<td align="center">12</td>
<td align="center">1</td>
<td align="right">12</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="left">Wizards</td>
<td align="right">14</td>
<td align="center">12</td>
<td align="center">2</td>
<td align="right">9</td>
<td align="center">5</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="left">Thunder</td>
<td align="right">15</td>
<td align="center">17</td>
<td align="center">2</td>
<td align="right">6</td>
<td align="center">9</td>
<td align="center">11</td>
</tr>
<tr class="even">
<td align="left">Bucks</td>
<td align="right">16</td>
<td align="center">11</td>
<td align="center">5</td>
<td align="right">14</td>
<td align="center">2</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="left">Pelicans</td>
<td align="right">17</td>
<td align="center">16</td>
<td align="center">1</td>
<td align="right">15</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Nets</td>
<td align="right">18</td>
<td align="center">22</td>
<td align="center">4</td>
<td align="right">25</td>
<td align="center">7</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="left">Suns</td>
<td align="right">19</td>
<td align="center">26</td>
<td align="center">7</td>
<td align="right">28</td>
<td align="center">9</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Knicks</td>
<td align="right">20</td>
<td align="center">17</td>
<td align="center">3</td>
<td align="right">22</td>
<td align="center">2</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="left">Clippers</td>
<td align="right">21</td>
<td align="center">23</td>
<td align="center">2</td>
<td align="right">19</td>
<td align="center">2</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="left">Pistons</td>
<td align="right">22</td>
<td align="center">7</td>
<td align="center">15</td>
<td align="right">13</td>
<td align="center">9</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="left">Mavericks</td>
<td align="right">23</td>
<td align="center">28</td>
<td align="center">5</td>
<td align="right">24</td>
<td align="center">1</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="left">Hawks</td>
<td align="right">24</td>
<td align="center">29</td>
<td align="center">5</td>
<td align="right">27</td>
<td align="center">3</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="left">Magic</td>
<td align="right">25</td>
<td align="center">21</td>
<td align="center">4</td>
<td align="right">23</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Heat</td>
<td align="right">26</td>
<td align="center">17</td>
<td align="center">9</td>
<td align="right">21</td>
<td align="center">5</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="left">Lakers</td>
<td align="right">27</td>
<td align="center">24</td>
<td align="center">3</td>
<td align="right">26</td>
<td align="center">1</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Grizzlies</td>
<td align="right">28</td>
<td align="center">24</td>
<td align="center">4</td>
<td align="right">20</td>
<td align="center">8</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="left">Kings</td>
<td align="right">29</td>
<td align="center">27</td>
<td align="center">2</td>
<td align="right">29</td>
<td align="center">0</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Bulls</td>
<td align="right">30</td>
<td align="center">30</td>
<td align="center">0</td>
<td align="right">30</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code># 直方图
ggplot(nba.shilibang.test, aes(胜率与PowerRanking差距)) + 
  geom_histogram(binwidth = 0.5)</code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
<div class="section level3">
<h3>这三个排名是否有明显差别？</h3>
<div class="section level4">
<h4>箱线图分析</h4>
<p>我们先画个箱线图看看三种排名两两差距的直方图。</p>
<pre class="r"><code>nba.shilibang.test[,c(&quot;球队&quot;, &quot;与实际胜率差距&quot;, &quot;与PowerRanking差距&quot;, &quot;胜率与PowerRanking差距&quot;)] %&gt;%
  gather(key = &quot;分组&quot;, value = &quot;差距&quot;, -c(1)) %&gt;%
  ggplot() + geom_boxplot(aes(分组, 差距, fill = 分组))</code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>从直方图来看两两差别都不大。</p>
</div>
<div class="section level4">
<h4>散点图分析</h4>
<pre class="r"><code>nba.shilibang.test[,c(1:3,5)] %&gt;% 
  gather(key = &quot;分组&quot;, value = &quot;排名&quot;, -c(1)) %&gt;%
  ggplot(aes(reorder(球队,排名), 排名, color = 分组)) + 
  geom_point(position = &quot;jitter&quot;) </code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>由散点图来看，效果还是不错的，对于头尾两部分的球队的实力来讲，三种排名差距不大。</p>
<p>而且存在这种差距都是很正常的，因为我的hgRanking和powerRanking都是对球队目前实力的评估，而胜率的排名是整个赛季的战绩的排名，并不能完全代表球队目前的实力。</p>
</div>
</div>
<div id="3" class="section level3">
<h3>回顾目前3个排名</h3>
<p>重新再回顾三个排名的情况，今天是Wed Dec 06 16:00:54 2017</p>
<pre class="r"><code>nba.shilibang &lt;- left_join(nba.shilibang, table.pr[,c(&quot;球队&quot;,&quot;powerRanking&quot;)], by = &quot;球队&quot;) %&gt;%
  arrange(hgRanking)
nba.shilibang %&gt;%  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">球队</th>
<th align="right">hgRanking</th>
<th align="center">本赛季胜率排名</th>
<th align="right">powerRanking</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Warriors</td>
<td align="right">1</td>
<td align="center">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Rockets</td>
<td align="right">2</td>
<td align="center">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Cavaliers</td>
<td align="right">3</td>
<td align="center">4</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">Raptors</td>
<td align="right">4</td>
<td align="center">5</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Celtics</td>
<td align="right">5</td>
<td align="center">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Spurs</td>
<td align="right">6</td>
<td align="center">6</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">Pacers</td>
<td align="right">7</td>
<td align="center">12</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="left">Timberwolves</td>
<td align="right">8</td>
<td align="center">10</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">Jazz</td>
<td align="right">9</td>
<td align="center">15</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">Nuggets</td>
<td align="right">10</td>
<td align="center">8</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="left">Hornets</td>
<td align="right">11</td>
<td align="center">20</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">76ers</td>
<td align="right">12</td>
<td align="center">8</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">TrailBlazers</td>
<td align="right">13</td>
<td align="center">12</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">Wizards</td>
<td align="right">14</td>
<td align="center">12</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">Thunder</td>
<td align="right">15</td>
<td align="center">17</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Bucks</td>
<td align="right">16</td>
<td align="center">11</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">Pelicans</td>
<td align="right">17</td>
<td align="center">16</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="left">Nets</td>
<td align="right">18</td>
<td align="center">22</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="left">Suns</td>
<td align="right">19</td>
<td align="center">26</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="left">Knicks</td>
<td align="right">20</td>
<td align="center">17</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">Clippers</td>
<td align="right">21</td>
<td align="center">23</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">Pistons</td>
<td align="right">22</td>
<td align="center">7</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">Mavericks</td>
<td align="right">23</td>
<td align="center">28</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">Hawks</td>
<td align="right">24</td>
<td align="center">29</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">Magic</td>
<td align="right">25</td>
<td align="center">21</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">Heat</td>
<td align="right">26</td>
<td align="center">17</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="left">Lakers</td>
<td align="right">27</td>
<td align="center">24</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="left">Grizzlies</td>
<td align="right">28</td>
<td align="center">24</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">Kings</td>
<td align="right">29</td>
<td align="center">27</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td align="left">Bulls</td>
<td align="right">30</td>
<td align="center">30</td>
<td align="right">30</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2>球队对比分析</h2>
<p>下面对比一下Warriors, Spurs, Cavaliers的各项数据。</p>
<pre class="r"><code># 上赛季5项对比
nba.shili.rescale %&gt;% 
  select(球队, 得分, 篮板, 组织, 防守, 罚球) %&gt;%
  dplyr::filter(球队 %in% compTeams) %&gt;%
  ggradar::ggradar(plot.data = .,font.radar = &quot;yahei&quot;,
                 group.point.size = 3, 
                 axis.label.size = 4, 
                 legend.text.size = 12) + 
  ggtitle(lastSeasonTitle)</code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code># 本赛季5项对比
thisSeason.nba.shili.rescale %&gt;% 
  select(球队, 得分, 篮板, 组织, 防守, 罚球) %&gt;%
  dplyr::filter(球队 %in% compTeams) %&gt;%
  ggradar::ggradar(plot.data = .,font.radar = &quot;yahei&quot;,
                 group.point.size = 3, 
                 axis.label.size = 4, 
                 legend.text.size = 12) +
  ggtitle(thisSeasonTitle)</code></pre>
<p><img src="/post/2017-12-06-create-my-nba-powerRanking_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
<pre class="r"><code># 排名对比
nba.shilibang %&gt;% dplyr::filter(球队 %in% compTeams) %&gt;%
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">球队</th>
<th align="right">hgRanking</th>
<th align="center">本赛季胜率排名</th>
<th align="right">powerRanking</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Warriors</td>
<td align="right">1</td>
<td align="center">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Cavaliers</td>
<td align="right">3</td>
<td align="center">4</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">Spurs</td>
<td align="right">6</td>
<td align="center">6</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2>数据来源</h2>
<ul>
<li><a href="https://www.basketball-reference.com" class="uri">https://www.basketball-reference.com</a></li>
<li><a href="http://www.espn.com/nba" class="uri">http://www.espn.com/nba</a></li>
</ul>
</div>
<div class="section level2">
<h2>特别说明</h2>
<p>上面的雷达图所表达的各项数据的差距大小，并不能代表不同球队的实力差距的大小，仅能代表该项数据在30支球队里面的不同排名。</p>
</div>
